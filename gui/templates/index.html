<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¿ƒçµé“¾æ¥ - æ¸©æš–ç–—æ„ˆé™ªä¼´</title>
    <link rel="stylesheet" href="{{ url_for('static',filename='css/index.css') }}" />
    <link rel="icon" href="{{ url_for('static',filename='images/favicon.ico') }}" type="image/x-icon">
    <script src="{{ url_for('static',filename='js/vue.js') }}"></script>
    <script src="{{ url_for('static',filename='js/element-ui.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static',filename='css/element/theme-chalk.css') }}" />
    <script src="{{ url_for('static',filename='js/index.js') }}" defer></script>
    <script src="{{ url_for('static',filename='js/script.js') }}" defer></script>
  </head>
  <body>
    <!-- é—ªçƒçš„æ˜Ÿæ˜ŸèƒŒæ™¯ -->
    <div class="stars-container">
      <div class="star star1">â­</div>
      <div class="star star2">âœ¨</div>
      <div class="star star3">â­</div>
      <div class="star star4">âœ¨</div>
      <div class="star star5">â­</div>
      <div class="star star6">âœ¨</div>
      <div class="star star7">â­</div>
      <div class="star star8">âœ¨</div>
      <div class="star star9">â­</div>
      <div class="star star10">âœ¨</div>
      <div class="star star11">â­</div>
      <div class="star star12">âœ¨</div>
      <div class="star star13">â­</div>
      <div class="star star14">âœ¨</div>
      <div class="star star15">â­</div>
    </div>
    <div id="app" class="main_bg">
      <div class="main_left">
        <div class="main_left_logo">
          <img src="{{ url_for('static',filename='images/Logo.png') }}" alt="">
        </div>

        <div class="main_left_menu">
          <ul>
            <li class="changeImg"><a href="/"><span class="iconimg1">ğŸ’¬ æ¶ˆæ¯</span></a></li>
            <li class="changeImg2"><a href="/setting"><span class="iconimg2">âœ¨ äººè®¾</span></a></li>
            <li class="changeImg4"><a href="/models"><span class="iconimg4">âš™ï¸ æ¨¡å‹ç®¡ç†</span></a></li>
            <li class="changeImg3" :class="{'mcp-online': mcpOnlineStatus}"><a :href="'http://' + hostname + ':5010/Page3'"><span class="iconimg3"><span class="mcp-online-indicator"></span>ğŸ”— MCP</span></a></li>
          </ul>
        </div>
        
        <div class="main_left_emoji">
          <img style="padding-top: 60px; max-width: 140px;" :src="robot" alt="">
        </div>
      </div>

      <div class="main_right">
        <div class="top_info">
          <span class="top_info_text">ğŸ’ å¿ƒçµå¯¹è¯ï¼š</span>[[panelMsg]]
          <span v-if="pure_mode_enabled" class="pure_mode_indicator">ã€çº¯å‡€AIåŠ©æ‰‹ã€‘</span>
          <span v-else class="character_mode_indicator">ã€æ¸©æš–é™ªä¼´ã€‘</span>
        </div>

        <div class="chatmessage">
          <div class="chat-container" id="user0">
            <div v-for="(item, index) in messages" :key="index">
              <div class="message receiver-message" v-if="item.type == 'fay'">
                <img class="avatar" src="{{ url_for('static',filename='images/Fay_send.png') }}" alt="æ¥æ”¶è€…å¤´åƒ">
                <div class="message-content">
                  <div class="message-bubble">[[item.content]]</div>
                  <div class="message-time">
                    <span class="what-time">[[item.timetext]]</span>
                    <div v-if="item.is_adopted == 0" class="adopt-button" @click="adoptText(item.id)">
                      <img src="{{ url_for('static',filename='images/adopt.png') }}" alt="é‡‡çº³å›¾æ ‡" class="adopt-img" />
                    </div>
                    <div v-else class="adopt-button">
                      <img src="{{ url_for('static',filename='images/adopted.png') }}" alt="é‡‡çº³å›¾æ ‡" class="adopt-img" />
                    </div>
                  </div>
                </div>
              </div>     
              <div class="message sender-message" v-else>
                <div class="message-content">
                  <div class="sender-message message-bubble">[[item.content]]</div>
                  <div class="sender-message-time">[[item.timetext]]</div>
                </div>
                <img class="avatar" src="{{ url_for('static',filename='images/User_send.png') }}" alt="å‘é€è€…å¤´åƒ">
              </div>
            </div>
          </div>
        </div>

        <div class="inputmessage">
          <div class="inputmessage_voice">
            <img v-if="!source_record_enabled" src="{{ url_for('static',filename='images/recording.png') }}" alt="" @click="changeRecord()">
            <img v-else src="{{ url_for('static',filename='images/record.png') }}" alt="" @click="changeRecord()">
          </div>
          <div class="inputmessage_input">
            <textarea class="text_in" placeholder="ğŸ’­ åœ¨è¿™é‡Œåˆ†äº«ä½ çš„æƒ³æ³•ï¼Œæˆ‘ä¼šå®‰é™åœ°å€¾å¬..." v-model="newMessage" @keyup.enter="sendMessage" style="padding-top: 13px;"></textarea>
          </div>
          <div class="inputmessage_send">
            <img src="{{ url_for('static',filename='images/send.png') }}" alt="å‘é€ä¿¡æ¯" @click="sendMessage">
          </div>

          <div v-if="liveState == 1" class="inputmessage_open">
            <img v-if="!play_sound_enabled" src="{{ url_for('static',filename='images/sound_off.png') }}" @click="changeSound()">
            <img v-else src="{{ url_for('static',filename='images/sound_on.png') }}" @click="changeSound()">
          </div>
          <div v-else class="inputmessage_open">
            <img src="{{ url_for('static',filename='images/open.png') }}" @click="startLive()">
          </div>

          <!-- çº¯å‡€AIæ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
          <div class="inputmessage_pure_mode">
            <div v-if="!pure_mode_enabled" @click="togglePureMode()" title="å½“å‰ï¼šæ•°å­—äººè§’è‰²æ¨¡å¼ï¼Œç‚¹å‡»åˆ‡æ¢åˆ°çº¯å‡€AIåŠ©æ‰‹" style="cursor: pointer; text-align: center;">
              <img src="{{ url_for('static',filename='images/Fay_send.png') }}" style="width: 30px; height: 30px; border-radius: 50%; border: 2px solid #ffc107;">
              <div style="font-size: 10px; color: #ffc107; margin-top: 2px;">è§’è‰²</div>
            </div>
            <div v-else @click="togglePureMode()" title="å½“å‰ï¼šçº¯å‡€AIåŠ©æ‰‹ï¼Œç‚¹å‡»åˆ‡æ¢åˆ°æ•°å­—äººè§’è‰²æ¨¡å¼" style="cursor: pointer; text-align: center;">
              <img src="{{ url_for('static',filename='images/User_send.png') }}" style="width: 30px; height: 30px; border-radius: 50%; border: 2px solid #28a745;">
              <div style="font-size: 10px; color: #28a745; margin-top: 2px;">çº¯å‡€</div>
            </div>
          </div>
        </div>

        <div class="Userchange">
          <button id="prevButton">
            <img src="{{ url_for('static',filename='images/scrollleft.png') }}" alt="å‘å·¦æ»‘åŠ¨">
          </button>
          <div class="menu" ref="menuContainer">
            <div class="tag" v-for="user in userList" :key="user[0]" :class="{'selected': selectedUser && selectedUser[0] === user[0]}" @click="selectUser(user)">
              [[ user[1] ]]
            </div>    
          </div>
          <button id="nextButton">
            <img src="{{ url_for('static',filename='images/scrollright.png') }}" alt="å‘å³æ»‘åŠ¨">
          </button>
        </div>
      </div>

      <!-- å›ºå®šåœ¨å³ä¾§çš„ think ä¿¡æ¯é¢æ¿ -->
      <div class="think-panel-container" v-show="thinkContent">
        <div class="think-panel">
          <div class="think-panel-header">
            <h4>æ€è€ƒå†…å®¹</h4>
            <button class="think-panel-minimize" @click="minimizeThinkPanel">
              <span class="think-panel-icon" v-if="isThinkPanelMinimized">+</span>
              <span class="think-panel-icon" v-else>-</span>
            </button>
          </div>
          <p>[[thinkContent]]</p>
        </div>
      </div>

    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // åˆå§‹åŒ– thinkContent
        if (typeof app !== 'undefined') {
          app.thinkContent = "";
        }
      });
    </script>
  </body>
</html>
